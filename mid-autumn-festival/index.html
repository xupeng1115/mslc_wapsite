<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
	<title>马上飞扬</title>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <meta content="telephone=no" name="format-detection" />
    <meta content="email=no" name="format-detection" />
    <link href="static/css/common.css" rel="stylesheet" type="text/css">
    
</head>

<body>
<!--横屏-->
<div class="page1" id="page1">
	<div class="music rotate360" id="music"><img src="static/images/music.png"></div>
	<div class="cover" id="cover">
		<div class="cover-cont">
			<div class="logo"><img src="static/images/logo.png" alt="logo">
				<span class="logo-mask" id="logoMask"></span>
			</div>
			<p class="txt"><span id="progress">0</span>%</p>
		</div>
	</div>
	<div class="main-content" id="mainContent">
		<div class="scene scene1 scene-trans" id="scene1">
			<div class="scene1-1 scene-trans"><img src="static/images/scene1-1.png" alt=""></div>
			<div class="scene1-2 scene-trans"><img src="static/images/scene1-2.png" alt=""></div>
			<div class="scene1-3 scene-trans"><img src="static/images/scene1-3.gif" alt=""></div>
			<div class="scene1-4 scene-trans"><img src="static/images/scene1-4.png" alt=""></div>
		</div>
		<!--/end 场景一-->
		<div class="scene scene2" id="scene2">
			<div class="scene2-1">
				<span class="scene2-2"><img src="static/images/scene2-2.png" alt=""></span>
				<span class="area area1"></span>
				<span class="area area2"></span>
				<span class="area area3"></span>
				<span class="area area4"></span>
				<span class="area area5"></span>
			</div>
		</div>
		<!--/end 场景二-->
		<div class="scene scene3" id="scene3">			
			<div class="scene3-left scene-trans"></div>
			<div class="scene3-right scene-trans"></div>
			<div class="scene3-result-img scene-trans"></div>
			<div class="scene3-1 scene-trans"><img src="static/images/scene3-1.png" alt=""></div>
			<div class="scene3-qr scene-trans"><img src="static/images/qr.png" alt=""></div>
			<div class="scene3-badge scene-trans">
				<ul class="clearfix">
					<li>
						<p class="badge-img"><img src="static/images/badge-bg.png"></p>
						<p class="badge-txt"><img src="static/images/badge-name-1.png"></p>
					</li>
					<li>
						<p class="badge-img"><img src="static/images/badge-bg.png"></p>
						<p class="badge-txt"><img src="static/images/badge-name-2.png"></p>
					</li>
					<li>
						<p class="badge-img"><img src="static/images/badge-bg.png"></p>
						<p class="badge-txt"><img src="static/images/badge-name-3.png"></p>
					</li>
					<li>
						<p class="badge-img"><img src="static/images/badge-bg.png"></p>
						<p class="badge-txt"><img src="static/images/badge-name-4.png"></p>
					</li>
					<li>
						<p class="badge-img"><img src="static/images/badge-bg.png"></p>
						<p class="badge-txt"><img src="static/images/badge-name-5.png"></p>
					</li>
					<li>
						<p class="badge-img"><img src="static/images/badge-bg.png"></p>
						<p class="badge-txt"><img src="static/images/badge-name-6.png"></p>
					</li>
				</ul>
			</div>
		</div>
		<!--/end 场景三-->
	</div>
</div>
<!--竖屏-->
<div class="page2">
	<div class="vertical-module flex flex-align-center flex-justify-center">
		<div class="vertical-cont">
			<p class="vertical-img rotate90"><img src="static/images/index.png" alt=""></p>
			<p class="vertical-txt">为了获得更好的体验，请使用竖屏浏览</p>
		</div>
	</div>
</div>
<audio src="static/images/music.mp3" autoplay="autoplay" loop="loop" id="audio"></audio>
<script src="static/js/jquery-1.11.3.min.js"></script>
<script src="static/js/common.js"></script>
<script>
$(function(){

	var $scene1 = $("#scene1");
	var $scene2 = $("#scene2");
	var $scene3 = $("#scene3");

	function imgArrLoad(){
		var imagesArr =[];
		imagesArr[0] = "static/images/scene1-1.png";
		imagesArr[1] = "static/images/scene1-2.png";
		imagesArr[2] = "static/images/scene1-3.gif";
		imagesArr[3] = "static/images/scene1-4.png";
		imagesArr[4] = "static/images/scene1-bg.jpg";
		imagesArr[5] = "static/images/scene2-1.png";
		imagesArr[6] = "static/images/scene2-2.png";
		imagesArr[7] = "static/images/index.png";
		imagesArr[8] = "static/images/scene3-1.png";
		imagesArr[9] = "static/images/badge-1.png";
		imagesArr[10] = "static/images/badge-2.png";
		imagesArr[11] = "static/images/badge-3.png";
		imagesArr[12] = "static/images/badge-4.png";
		imagesArr[13] = "static/images/badge-5.png";
		imagesArr[14] = "static/images/badge-6.png";
		imagesArr[15] = "static/images/badge-bg.png";
		imagesArr[16] = "static/images/badge-name-1.png";
		imagesArr[17] = "static/images/badge-name-2.png";
		imagesArr[18] = "static/images/badge-name-3.png";
		imagesArr[19] = "static/images/badge-name-4.png";
		imagesArr[20] = "static/images/badge-name-5.png";
		imagesArr[21] = "static/images/badge-name-6.png";

		loadProcess(30,imagesArr,scene1Animate);
	}
	
	//场景一入场动画
	function scene1Animate(){
		var $scene1to1 = $scene1.find(".scene1-1");
		var $scene1to2 = $scene1.find(".scene1-2");
		var $scene1to3 = $scene1.find(".scene1-3");
		var $scene1to4 = $scene1.find(".scene1-4");
		$scene1.addClass('show');
		
		$scene1.one("webkitAnimationEnd",function(){
			$scene1to1.addClass('show');
			$scene1to2.addClass('show');
			$scene1to3.addClass('show');
			$scene1to4.addClass('show');
		})
		
		$scene1to4.on("click",scene2Animate);
	}

	//场景二入场动画
	function scene2Animate(){
		var $nose = $scene2.find(".scene2-2");

		$scene2.css("opacity","1");
		$scene1.css("top","-100%");

		setTimeout(function(){
			$nose.addClass('noseAni');
			throughArea($scene2,function(){
				//此处ajax回调后传入一个值result
				//result为召唤结果，可为数字0-6
				//0失败，1五仁，2蛋黄，3芝麻，4豆沙，5椰奶，6莲蓉
				var result = Math.floor((Math.random()*7));//临时测试用

				scene3Animate(result);
			})
		},800)
	}

	//场景三入场动画
	function scene3Animate(result){
		var $scene3Left = $scene3.find(".scene3-left");
		var $scene3Right = $scene3.find(".scene3-right");
		var $scene3to1 = $scene3.find(".scene3-1");
		var $badge = $scene3.find(".scene3-badge");
		var $scene3QR = $scene3.find(".scene3-qr");
		var $scene3ResultImg = $scene3.find(".scene3-result-img");
		var value = result!==undefined?result:$scene3ResultImg.data("value");
		var resultImgSrc = locationStr+"static/images/self-result-"+value+".png";
		var badgeImgSrc = locationStr+"static/images/badge-"+value+".png";
		var badgeImg = $badge.find('.badge-img');
		
		$scene3.addClass('scene3-result-'+value).css({"z-index":"8","opacity":"1"})
		$scene3Left.removeClass("hide").addClass('show');
		$scene3Right.removeClass("hide").addClass('show');
		$scene3ResultImg.append('<img src="'+resultImgSrc+'" >')
		$scene3Right.one("webkitAnimationEnd",function(){
			//召唤结果图片加载成功后执行动画
			loadImage(resultImgSrc,function(){
				if(value==0){
					$scene3to1.removeClass("hide").addClass('show');
				}else{
					badgeImg.eq(value-1).find('img').attr("src",badgeImgSrc);
					$badge.addClass('show');
					$badge.one("webkitAnimationEnd",function(){
						$scene3QR.addClass('show');
						badgeImg.eq(value-1).addClass('zoom');
					})
				}
				$scene3ResultImg.removeClass("hide").addClass('show');
			})		
		})
		$scene3to1.on("click",function(){
			$scene3to1.removeClass('show').addClass('hide');
			$scene3ResultImg.removeClass('show').addClass('hide');
			$scene3ResultImg.one("webkitAnimationEnd",function(){
				$scene3ResultImg.empty();
				$scene3Left.removeClass('show').addClass('hide');
				$scene3Right.removeClass('show').addClass('hide');
				$scene3Right.one("webkitAnimationEnd",function(){
					$scene3.removeClass('scene3-result-'+value).css({"z-index":"7","opacity":"0"})
				})
				
			})
		})
	}

	//logo背景图加载成功后执行加载动画
	loadImage(locationStr+"static/images/logo.png",imgArrLoad);

})	
</script>
<!--微信分享-->
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script type="text/javascript">
var imgUrl = locationStr+"static/images/share.png";
var lineLink = "";
var descContent = '卡莫，北鼻们！领月饼啦～';
var shareTitle = '召唤北鼻  领取“哈根达斯”';

// wx.config({
//     debug: false,
//     appId: '<?php echo $signPackage["appId"];?>',
//     timestamp: <?php echo $signPackage["timestamp"];?>,
//     nonceStr: '<?php echo $signPackage["nonceStr"];?>',
//     signature: '<?php echo $signPackage["signature"];?>',
//     jsApiList: ['onMenuShareTimeline','onMenuShareAppMessage','onMenuShareQQ','onMenuShareWeibo'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
// });

// wx.ready(function(){
// 	wx.onMenuShareAppMessage({
// 	    title: shareTitle, // 分享标题
// 	    desc: descContent, // 分享描述
// 	    link: lineLink, // 分享链接
// 	    imgUrl: imgUrl, // 分享图标
// 	    type: '', // 分享类型,music、video或link，不填默认为link
// 	    dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
// 	    success: function () { 
// 	        // 用户确认分享后执行的回调函数
// 	    },
// 	    cancel: function () { 
// 	        // 用户取消分享后执行的回调函数
// 	    }
// 	});

// 	wx.onMenuShareTimeline({
// 	    title: shareTitle, // 分享标题
// 	    link: lineLink, // 分享链接
// 	    imgUrl: imgUrl, // 分享图标
// 		desc: descContent, // 分享描述
// 	    success: function () { 
// 	        // 用户确认分享后执行的回调函数
// 	    },
// 	    cancel: function () { 
// 	        // 用户取消分享后执行的回调函数
// 	    }
// 	});
// 	wx.onMenuShareQQ({
// 	    title: shareTitle, // 分享标题
// 	    desc: descContent, // 分享描述
// 	    link: lineLink, // 分享链接
// 	    imgUrl: imgUrl, // 分享图标
// 	    success: function () { 
// 	       // 用户确认分享后执行的回调函数
// 	    },
// 	    cancel: function () { 
// 	       // 用户取消分享后执行的回调函数
// 	    }
// 	});

// 	wx.onMenuShareWeibo({
// 	    title: shareTitle, // 分享标题
// 	    desc: descContent, // 分享描述
// 	    link: lineLink, // 分享链接
// 	    imgUrl: imgUrl, // 分享图标
// 	    success: function () { 
// 	       // 用户确认分享后执行的回调函数
// 	    },
// 	    cancel: function () { 
// 	        // 用户取消分享后执行的回调函数
// 	    }
// 	});

// });
</script>
</body>
</html>
