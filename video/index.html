<!DOCTYPE html>
<html lang=en class="full">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chromme=1.0"/>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
	<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="format-detection" content="email=no"/>
	<title>看直播，买理财</title>
	<link rel="stylesheet" href="css/swiper-3.4.0.min.css" type="text/css"/>
	<link rel="stylesheet" href="css/video.css?ver=20161111" type="text/css"/>
</head>
<body class="full">
	
<!--logo信息-->
<div class="top">
	<img src="img/logo_mashanglc.png" class="logo"/>
	<p class="logo-name">马上理财</p>
	<p class="logo-dec">直连银行</p>
	<div class="open">立即打开</div>
</div>

<!--分享直播信息-->
<div class="content">
	
	<!--正在直播部分-->
	<div class="direct-box">
		<!--<video height="100%" controls poster="img/direct.png" tit="0" src="http://mslicai.oss-cn-hangzhou.aliyuncs.com/record/mslc/test.m3u8"></video>
		<div class="download-btn">打开马上理财APP 互动更精彩</div>-->
		
	</div>
	
	<!--直播预告部分-->
	<div class="direct-prevue-box">
		<!--<img src="" onerror="this.src='img/direct.png'" class="direct-pic bg-filter"/>
		<div class="mask-top">
			<p class="prevue-title-txt-top">陈老师教你如何</p>
			<p class="prevue-title-txt-bottom">在逆回购过程中获得收益</p>
			<p class="prevue-title-dec">虽然国债收益率不断下降，但现在三年期国债收益率也有3.8%，五年期的收益率有4.17%，比银行同期存款收益率高。更何况，国债与其他理财国债与其他理财...</p>
			<p class="begin-open">
				<span class="begin-open-date">距离11月08日</span>
				<span class="begin-open-time">18:00直播开始还有</span>
			</p>
			
			<div class="timer"> 
				<span class="day num">00</span>
				<span class="bg01 bg"><span class="bg-line"></span></span>
				<span class="day-txt txt">天</span>
				<span class="hour num">00</span>
				<span class="bg02 bg"><span class="bg-line"></span></span>
				<span class="hour-txt txt">时</span>
				<span class="minute num">00</span>
				<span class="bg03 bg"><span class="bg-line"></span></span>
				<span class="minute-txt txt">分</span>
				<span class="second num">00</span>
				<span class="bg04 bg"><span class="bg-line"></span></span>
				<span class="second-txt txt">秒</span>
			</div>
			<div class="begin-open-remain">提醒我</div>
		</div>-->
	</div>
	
	
	<!--直播结束部分-->
	<div class="direct-end-box">
		<!--<img src="" onerror="this.src='img/direct.png'" class="direct-pic"/>
		<div class="mask-top">
			<div class="end-txt">直播已结束</div>
			<div class="end-msg">
				<div class="view">
					<p class="view-number num">345</p>
					<p class="view-txt txt">观看人数</p>
				</div>
				<div class="like">
					<p class="like-number num">91</p>
					<p class="like-txt txt">点赞人数</p>
				</div>
				<div class="line"></div>
			</div>
			<div class="query-back-btn">查看回播</div>
		</div>-->
	</div>
	
</div>

<!--直播经理信息-->
<div class="direct-manager" style="display:none;">
	<!--<img src="img/head.png" class="direct-manager-pic" onerror="this.src='img/head.png'"/>
	<p class="direct-manager-name">陈撒耶</p>
	<p class="direct-manager-dec">平安银行陆家嘴支行 理财经理</p>
	<div class="attention">关注</div>-->
</div>

<!--直播经理推荐理财产品信息-->
<div class="recommend-product">
	<!--<div class="recommend-top">
		
		<p class="recommend-title"><span class="recommend-icon"></span>主播推荐</p>
		<p class="recommend-num">2个</p>
	</div>
	<div class="swiper-container">
	    <div class="swiper-wrapper">
	        <div class="swiper-slide">
	        	<div class="product">
	        		<div class="product-name">平安银行平安财富资本管理ERWERWE12342342</div>
	        		<p class="yield-rate">
	        			<span class="yield">4.25</span>
	        			<span class="add">+</span>
	        			<span class="interest">0.15</span>
	        		</p>
	        		<p class="yield-txt">预期年化收益(%)</p>
	        		<p class="date">361天</p>
	        		<p class="money">5万起购</p>
	        	</div>
	        </div>
	        <div class="swiper-slide">
	        	<div class="product">
	        		<div class="product-name">平安银行平安财富资本管理ERWERWE12342342</div>
	        		<p class="yield-rate">
	        			<span class="yield">4.25</span>
	        			<span class="add">+</span>
	        			<span class="interest">0.15</span>
	        		</p>
	        		<p class="yield-txt">预期年化收益(%)</p>
	        		<p class="date">不固定</p>
	        		<p class="money">5万起购</p>
	        	</div>
	        </div>
	        <div class="swiper-slide">
	        	<div class="product">
	        		<div class="product-name">平安银行平安财富资本管理ERWERWE12342342</div>
	        		<p class="yield-rate">
	        			<span class="yield">4.25</span>
	        		</p>
	        		<p class="yield-txt">预期年化收益(%)</p>
	        		<p class="date">361天</p>
	        		<p class="money">5万起购</p>
	        	</div>
	        </div>
	        <div class="swiper-slide">
	        	<div class="product">
	        		<div class="product-name">平安银行平安财富资本管理ERWERWE12342342</div>
	        		<p class="yield-rate">
	        			<span class="yield">4.25</span>
	        			<span class="add">+</span>
	        			<span class="interest">0.15</span>
	        		</p>
	        		<p class="yield-txt">预期年化收益(%)</p>
	        		<p class="date">361天</p>
	        		<p class="money">10000万起购</p>
	        	</div>
	        </div>
	    </div>
	</div>-->
</div>

<!--热门正在直播-->
<div class="hot-direct">
	<!--<div class="hot-top"><span class="hot-icon"></span>热门直播</div>
	<div class="hot-direct-list">
		<div class="hot-item">
    		<img src="img/item01.png" onerror='this.src="img/item01.png"' class="item-pic"/>
    		<p class="hot-item-title">理财产品如何搭配</p>
    	</div>
    	<div class="hot-item">
        	<img src="img/item02.png" onerror='this.src="img/item01.png"' class="item-pic"/>
        	<p class="hot-item-title">如何在逆回购中获得收益等等等等等</p>
       </div>
    	<div class="hot-item">
        	<img src="img/item01.png" onerror='this.src="img/item01.png"' class="item-pic"/>
        	<p class="hot-item-title">理财产品如何搭配</p>
       </div>
    	<div class="hot-item">
        	<img src="img/item02.png" onerror='this.src="img/item01.png"' class="item-pic"/>
        	<p class="hot-item-title">如何在逆回购中获得收益等等等等等等等等等等</p>
       </div>
       <div class="hot-item">
        	<img src="img/item02.png" onerror='this.src="img/item01.png"' class="item-pic"/>
        	<p class="hot-item-title">如何在逆回购中获得收益等等等等等等等等等等</p>
       </div>
	</div>-->
	
</div>

<!--清除浮动-->
<div class="clearfix"></div>

<!--预告将要直播-->
<div class="prevue-direct">
	<!--<div class="prevue-top">
		<p class="prevue-title"><span class="prevue-icon"></span>直播预告</p>
		<p class="prevue-txt">全部提醒</p>
	</div>
	<div class="prevue-list">
		<div class="prevue-item">
			<div class="prevue-item-top">
				<span class="prevue-item-date">9月13日(周三)</span>
				<span class="prevue-item-time">13:00</span>
			</div>
			<img src="img/head.png" class="prevue-manager-pic" onerror="this.src='img/head.png'"/>
			<p class="prevue-manager-dec">理财产品的搭配理财产品的搭配理财产品的搭配理财产品的搭配理财产品的搭配</p>
			<p class="prevue-manager-name">郑琳</p>
			<p class="remain-self">提醒我</p>
		</div>
		<div class="prevue-item">
			<div class="prevue-item-top">
				<span class="prevue-item-icon"></span>
				<span class="prevue-item-date">9月13日(周三)</span>
				<span class="prevue-item-time">13:00</span>
			</div>
			<img src="img/head.png" class="prevue-manager-pic" onerror="this.src='img/head.png'"/>
			<p class="prevue-manager-dec">理财产品的搭配理财产品的搭配理财产品的搭配理财产品的搭配理财产品的搭配</p>
			<p class="prevue-manager-name">郑琳</p>
			<p class="remain old">已提醒</p>
		</div>
		<div class="prevue-item">
			<div class="prevue-item-top">
				<span class="prevue-item-icon"></span>
				<span class="prevue-item-date">9月13日(周三)</span>
				<span class="prevue-item-time">13:00</span>
			</div>
			<img src="img/head.png" class="prevue-manager-pic" onerror="this.src='img/head.png'"/>
			<p class="prevue-manager-dec">理财产品的搭配理财产品的搭配理财产品的搭配理财产品的搭配理财产品的搭配</p>
			<p class="prevue-manager-name">郑琳</p>
			<p class="remain">提醒</p>
		</div>
		<div class="prevue-item">
			<div class="prevue-item-top">
				<span class="prevue-item-icon"></span>
				<span class="prevue-item-date">9月13日(周三)</span>
				<span class="prevue-item-time">13:00</span>
			</div>
			<img src="img/head.png" class="prevue-manager-pic" onerror="this.src='img/head.png'"/>
			<p class="prevue-manager-dec">理财产品的搭配理财产品的搭配理财产品的搭配理财产品的搭配理财产品的搭配</p>
			<p class="prevue-manager-name">郑琳</p>
			<p class="remain-self">提醒我</p>
		</div>
	</div>-->
</div>

<!--全局蒙层弹窗-->
<div class="flo-box">
	<div class="mask" style="display:none;">
		
		<!--列表项中点击“提醒我”的输入手机号码弹窗-->
		<div class="int-list" style="display:none;">
			<p class="int-list-txt">请您留下手机号码，我们会在下一次直播时提前发送短信息通知给您，精彩不再错过!</p>
			<input type="text" placeholder="请输入手机号" id="list-phone-number"/>
			<div class="list-btn">
				<div class="list-cancle">取消</div>
				<div class="list-confirm">确定</div>
			</div>
		</div>
		
		<!--内容页中点击“提醒我”的输入手机号码弹窗-->
		<div class="int-page" style="display:none;">
			<p class="int-page-txt">请您留下手机号码，我们会在下一次直播时提前发送短信息通知给您，精彩不再错过!</p>
			<input type="text" placeholder="请输入手机号" id="page-phone-number"/>
			<div class="page-btn">
				<div class="page-cancle">取消</div>
				<div class="page-confirm">确定</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript" src="js/zepto.min.js"></script>
<script type="text/javascript" src="js/swiper-3.4.0.min.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="js/md5.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="js/wx.js"></script>


<script type="text/javascript">
	
	var publicObj = {
		isWeixin:isWeixin(),
		phoneType:getOS(),
		userType:1,
		domainname:"http://" + location.hostname,
		videoUrl:publicApiHost + "/v2/api/web/video/info",
		appVer:"1.0",
		roomId:getUrlParameter("roomId"),
		timestamp:new Date().getTime(),
		deviceType:"mobile_web"
	};
	
	var _r = publicObj.timestamp+"msfy_mslc_20160526_w"+publicObj.appVer+publicObj.deviceType+"web"+publicObj.appVer;
	publicObj.signature=hex_md5(_r);

	var _params = {
		userType:publicObj.userType,
		appVer: publicObj.appVer,
		deviceType: publicObj.deviceType,
		timestamp: publicObj.timestamp,
		signature: publicObj.signature,
		deviceId: "wap",
		osVer: getOS(),
		roomId:publicObj.roomId
	};
	
	//设置分享相关参数
	var shareParameters={};
	
	//回放相关参数
	var backDirectParameters={};
	
	Zepto(function($){
		
		//获取页面信息
		$.ajax({
			type:'GET',
			url:publicObj.videoUrl,			//"direct.json"
			dataType:'json',
			data:_params,
			timeout:30000,
			success:function(data){
				
				console.log(data);
				
				var error=data.error;
				
				if(error==0){
					var data=data.data;
					var video=data.video;
					var hots=data.hots;
					var products=data.products;
					var forecast=data.forecast;
					
					if(video&&video!=''){
						
						//预告直播
						if(video.type==0){
							//预告
							if(video.status==0){
								getPrevuePage(video);
							}
							
							//直播中
							if(video.status==1){
								getVideoPlayer(video);
							}
							
							//回放
							if(video.status==2){
								backDirectParameters.cover=video.cover;
								backDirectParameters.url=video.url;
								getDirectEnd(video);
							}
						}
						
						//正在播放直播
						if(video.type==1){
							getVideoPlayer(video);
						}
						
						//直播回放
						if(video.type==2){
							
//							backDirectParameters.cover=video.cover;
//							backDirectParameters.url=video.url;
//							getDirectEnd(video);
							getVideoPlayer(video);
						}
						
						//直播经理信息
						if(video.author&&video.author!=''){
							getManagerMsg(video.author);
						}
						
						//获取直播分享参数
						shareDirect(video);
						
					}
					
					//直播推荐产品
					if(products&&products!=''){
						getRecommendProduct(products);
					}
					
					//热门直播
					if(hots&&hots!=''){
						getHotDirect(hots);
					}
					
					//预约直播
					if(forecast&&forecast!=''){
						getPrevueDirect(forecast);
					}
					
				}else{
					g_alert("请求错误");
				}

			},
			error:function(){
				g_alert("网络错误");
			}
		})
		
		//直播时调整点击按钮位置
		function getDirect(){
			
			$("video").css("marginTop",-($("video").height()-$(".content").height())/2+"px");
		}
		
		//初始化倒计时时间
		var oTimer=1;
		
		//生成倒计时时间
		function Timer(){
			
			var oDate1=new Date();
			
			var oValue=oTimer*1000-oDate1.getTime();
			if(oValue>0){
				oValue=window.parseInt((oValue/1000));
				
				//真正的秒
				var oSecond=oValue%60;		
				if(oSecond<10){
					oSecond='0'+oSecond;
				}
				
				oValue=(oValue-oSecond)/60;
				
				//真正的分钟
				var oMinute=oValue%60;			
				if(oMinute<10){
					oMinute='0'+oMinute;
				}
				
				oValue=(oValue-oMinute)/60;
				
				//真正的小时
				var oHour=oValue%24;				
				if(oHour<10){
					oHour='0'+oHour;
				}	
				
				//真正的天数	
				var oDay=(oValue-oHour)/24;	
				if(oDay<10){
					oDay='0'+oDay;
				}
				
				$(".second").text(oSecond);
				$(".minute").text(oMinute);
				$(".hour").text(oHour);
				$(".day").text(oDay);
				
				(!(oSecond=='00'&&oMinute=='00'&&oHour=='00'&&oDay=='00'))&&setTimeout(arguments.callee,1000);
				
			}
		}
		
		//直播播放器
		function getVideoPlayer(data){
			
			$(".content").css("height",$(".content").width()+"px");
			
			var str='',cover='';
			if(data.cover&&data.cover!=''){
				cover=data.cover;
			}else{
				cover='img/direct.png';
			}
			
			str+='<video height="100%" controls poster="'+cover+'" tit="0" src="'+data.url+'"></video><div class="download-btn">打开马上理财APP 互动更精彩</div>';
			
			$(".direct-box").html(str);
			
			if(($("video").height())>=($(".content").height())){

				//调整播放器按钮位置
				getDirect();
				
			}else{
				$(".content").css("height",$("video").height()+"px");
			}
			
		}
	
		//直播理财经理信息
		function getManagerMsg(data){
			
			$(".direct-manager").css("display","block");
			var str='',cover='';
			
			if(data.managerInfo&&data.managerInfo!=''){
				if(data.managerInfo.smallCover&&data.managerInfo.smallCover!=''){
					cover=data.managerInfo.smallCover;
				}else{
					cover='img/initial_head.png';
				}
				
				str+='<img src="'+cover+'" class="direct-manager-pic"'+' onerror='+'this.src="img/initial_head.png"'+'/>';
				str+='<p class="direct-manager-name">'+data.managerInfo.calledName+'</p>';
				str+='<p class="direct-manager-dec">'+data.managerInfo.bankBranch.bankName+data.managerInfo.bankBranch.name+' 理财经理</p>';
			}
			
			$(".direct-manager").html(str);
			
			
		}
		
		//主播推荐列表
		function getRecommendProduct(data){
			var str='';
				
			str+='<div class="recommend-top"><p class="recommend-title"><span class="recommend-icon"></span>主播推荐</p><p class="recommend-num">'+data.length+'个</p></div>';
			str+='<div class="swiper-container"><div class="swiper-wrapper">';
			
			for(var i=0;i<data.length;i++){
				str+='<div class="swiper-slide"><div class="product">';
				
				if(data[i].name&&data[i].name!=''){
					str+='<div class="product-name">'+data[i].name+'</div>';
				}else{
					str+='<div class="product-name">'+'银行精选理财产品'+'</div>';
				}
				
				
				if(data[i].estimatedYearRate&&data[i].estimatedYearRate>0&&data[i].estimatedYearRate!=''){
					
					var estimatedYearRate=parseFloat(data[i].estimatedYearRate/100.0).toFixed(2);
					str+='<p class="yield-rate">';
					str+='<span class="yield">'+estimatedYearRate+'</span>';
					
					if(data[i].redeemRate&&data[i].redeemRate>0&&data[i].redeemRate!=''){
						var redeemRate=parseFloat(data[i].redeemRate).toFixed(2);
						str+='<span class="add">+</span><span class="interest">'+redeemRate+'</span>';
					}
					
					str+='</p>';
				}
				
				if(data[i].redeemRate&&data[i].redeemRate>0&&data[i].redeemRate!=''){
					str+='<p class="yield-txt">预期年化收益+加息奖励(%)</p>';
				}else{
					str+='<p class="yield-txt">预期年化收益(%)</p>';
				}
				
				if(data[i].duration&&data[i].duration!=''){
					str+='<p class="date">'+data[i].duration+'天</p>';
				}else{
					str+='<p class="date">不固定</p>';
				}
        		str+='<p class="money">'+data[i].minimumPurchase+'万起购</p>';
        		str+='</div></div>';
			}
			
			str+='</div></div>';
			
			$(".recommend-product").html(str);
			
			//轮播理财产品
			var mySwiper = new Swiper('.swiper-container',{
					direction: 'horizontal',
					freeMode :true,
					freeModeMomentum :true,
					slidesPerView:'auto',
				})
		}
		
		//热门直播列表
		function getHotDirect(data){
			var str='',cover='';

			str+='<div class="hot-top"><span class="hot-icon"></span>热门直播</div><div class="hot-direct-list">';
			
			for(var i=0;i<data.length;i++){
				if(data[i].smallCover&&data[i].smallCover!=''){
					cover=data[i].smallCover;
				}else{
					cover="img/item01.png";
				}
				str+='<div class="hot-item"><img src="'+cover+'" class="item-pic"'+' onerror='+'this.src="img/item01.png"'+'/>';
				str+='<p class="hot-item-title">'+data[i].title+'</p></div>';
			}
			
			str+='</div>';
			$(".hot-direct").html(str);
			
		}
		
		//直播预告列表
		function getPrevueDirect(data){
			var str='',cover='';
				
			str+='<div class="prevue-top"><p class="prevue-title"><span class="prevue-icon"></span>直播预告</p><p class="prevue-txt">全部提醒</p></div>';
			str+='<div class="prevue-list">';
			
			for(var i=0;i<data.length;i++){
				
				str+='<div class="prevue-item"><div class="prevue-item-top">';
				
				if(data[i].startAt&&data[i].startAt!=''){
					var oTime=getPrevueTime(data[i].startAt);
					str+='<span class="prevue-item-date">'+oTime.month+'月'+oTime.day+'日'+'('+oTime.weekTxt+')'+'</span><span class="prevue-item-time">'+oTime.hour+':'+oTime.minute+'</span></div>';
				}
				
				if(data[i].author.managerInfo.smallCover&&data[i].author.managerInfo.smallCover!=''){
					cover=data[i].author.managerInfo.smallCover;
				}else{
					cover="img/initial_head.png";
				}
				
				str+='<img src="'+cover+'" class="prevue-manager-pic"'+' onerror='+'this.src="img/initial_head.png"'+'/>';
				str+='<p class="prevue-manager-dec">'+data[i].title+'</p>';
				str+='<p class="prevue-manager-name">'+data[i].author.managerInfo.calledName+'</p>';
				str+='<p class="remain" key="1" active>提醒我</p>';
				str+='</div>';
			}
				
			str+='</div>';
				
			$(".prevue-direct").html(str);
		}
		
		//预告直播页
		function getPrevuePage(data){
			document.title=data.title;
			var str='',cover='';
			
			if(data.cover&&data.cover!=''){
				cover=data.cover;
			}else{
				cover="img/direct.png";
			}
			
			str+='<img src="'+cover+'" class="direct-pic bg-filter"'+' onerror='+'this.src="img/direct.png"'+'/>';
			
			str+='<div class="mask-top">';
			if(data.title&&data.title!=''){
				
				var oTitle=getTitle(data.title);
				str+=oTitle;
			}
			
			if(data.description&&data.description!=''){
				var description=getDescription(data.description);
				str+=description;
			}
			
			str+='<p class="begin-open">';
			if(data.startAt&&data.startAt!=''){

				//取到倒计时结束时间
				var oTimeEnd=getPrevueTime(data.startAt);
				str+='<span class="begin-open-date">距离'+oTimeEnd.month+'月'+oTimeEnd.day+'日</span><span class="begin-open-time">'+oTimeEnd.hour+':'+oTimeEnd.minute+'直播开始还有</span>';
				
				//生成倒计时
				oTimer=data.startAt;
			}
			
			str+='<div class="timer">'; 
			str+='<span class="day num">00</span>';
			str+='<span class="bg01 bg"><span class="bg-line"></span></span>';
			str+='<span class="day-txt txt">天</span>';
			str+='<span class="hour num">00</span>';
			str+='<span class="bg02 bg"><span class="bg-line"></span></span>';
			str+='<span class="hour-txt txt">时</span>';
			str+='<span class="minute num">00</span>';
			str+='<span class="bg03 bg"><span class="bg-line"></span></span>';
			str+='<span class="minute-txt txt">分</span>';
			str+='<span class="second num">00</span>';
			str+='<span class="bg04 bg"><span class="bg-line"></span></span>';
			str+='<span class="second-txt txt">秒</span>';
			str+='</div>';
			
			str+='</p>';
			
			str+='<div class="begin-open-remain" key="1">提醒我</div>';
			
			str+='</div>';
			
			$(".direct-prevue-box").html(str);
			
			$(".direct-pic").css("height","100%");
			
			//倒计时函数
			Timer();
		}
		
		//直播结束内容页
		function getDirectEnd(data){

			var str='',cover='';
			
			if(data.cover&&data.cover!=''){
				cover=data.cover;
			}else{
				cover="img/direct.png";
			}
			str+='<img src="'+cover+'" class="direct-pic"'+' onerror='+'this.src="img/direct.png"'+'/>';
			str+='<div class="mask-top"><div class="end-txt">直播已结束</div><div class="end-msg">';
			
			if(data.viewCount&&data.viewCount!=''){
				str+='<div class="view"><p class="view-number num">'+data.viewCount+'</p><p class="view-txt txt">观看人数</p></div>';
			}else{
				str+='<div class="view"><p class="view-number num">0</p><p class="view-txt txt">观看人数</p></div>';
			}
			
			if(data.likeCount&&data.likeCount!=''){
				str+='<div class="like"><p class="like-number num">'+data.likeCount+'</p><p class="like-txt txt">点赞人数</p></div>';
			}else{
				str+='<div class="like"><p class="like-number num">0</p><p class="like-txt txt">点赞人数</p></div>';;
			}
			
			str+='<div class="line"></div></div>';
			
			if(data.url&&data.url!=''){
				str+='<div class="query-back-btn">查看回播</div>';
			}
			
			str+='</div>';
			
			$(".direct-end-box").html(str);
			
			//判断图片是大图还是小图
			if($(".direct-pic").height()<$(".content").height()){
				
				$(".direct-pic").css("height",$(".direct-pic").width()+"px");
				$(".content").css("height",$(".direct-pic").height()+"px");
				
				if($(".direct-pic").width()<=360){
					$(".end-txt").css("paddingTop","120px");
					$(".query-back-btn").css({"marginTop":"0px","marginBottom":"20px"});
					if($(".direct-pic").width()<=320){
						$(".end-txt").css("paddingTop","100px");
					}
				}else{
					$(".end-txt").css("paddingTop","120px");
					$(".query-back-btn").css("marginBottom","20px");
				}
			}
			
		}
	
		//直播预告时间
		function getPrevueTime(data){
			
			var str='';
			var oDate=new Date(data*1000);
			
			var oWeek={
				0:"周日",
				1:"周一",
				2:"周二",
				3:"周三",
				4:"周四",
				5:"周五",
				6:"周六"
			}
			
			var oTime={
				month:oDate.getMonth()+1,
				week:oDate.getDay(),
				day:oDate.getDate(),
				hour:oDate.getHours(),
				minute:oDate.getMinutes(),
				second:oDate.getSeconds(),
				weekTxt:''
			}
			
			for(var i in oWeek ){
				if(i==oTime.week){
					oTime.weekTxt=oWeek[i];
				}
			}
			
			if(oTime.hour<10){
				oTime.hour="0"+oTime.hour;
			}
			
			if(oTime.minute<10){
				oTime.minute="0"+oTime.minute;
			}
			if(oTime.second<10){
				oTime.second="0"+oTime.second;
			}
			
			return oTime;
		}
		
		//生成预告直播页标题
		function getTitle(data){
			
			var str='',str1='',str2='';
			var oLength=$.trim(data).length;
			
			if(oLength<=11){
				str='<p class="prevue-title-txt-top">'+data+'</p>';
			}
			if(oLength>11&&oLength<16){
				str1=data.substring(0,11);
				str2=data.substring(11);
				str='<p class="prevue-title-txt-top">'+str1+'</p><p class="prevue-title-txt-bottom">'+str2+'</p>';
			}
			if(oLength>=16){
				str1=data.substring(0,7);
				str2=data.substring(7);
				str='<p class="prevue-title-txt-top prevue-title-txt-one">'+str1+'</p><p class="prevue-title-txt-bottom">'+str2+'</p>';
			}
		
			return str;
		}
		
		//获取直播预告页标题描述文字
		function getDescription(data){
			
			var str='',txt=$.trim(data);
			var oLength=$.trim(data).length;
			
			if(oLength<=21){
				str='<p class="prevue-title-dec">'+txt+'</p>';
			}
			
			if((oLength>21)&&(oLength<=70)){
				str='<p class="prevue-title-dec prevue-title-dec-left">'+txt+'</p>';
			}
			
			if(oLength>70){
				txt=data.substring(0,70);
				str='<p class="prevue-title-dec prevue-title-dec-left">'+txt+'...'+'</p>';
			}
			
			return str;
		}
		
		
		//分享直播
		function shareDirect(data){
			
			if(data.smallCover&&data.smallCover!=''){
				shareParameters.icon=data.smallCover;
			}else{
				shareParameters.icon="img/logo_mashanglc.png";
			}
			
			if(data.title&&data.title!=''){
				shareParameters.title=data.title;
				shareParameters.circleTitle=data.title;
			}else{
				shareParameters.title="马上理财直播";
				shareParameters.circleTitle="马上理财直播";
			}
			
			if(data.author.managerInfo.calledName&&data.author.managerInfo.calledName!=''){
				if(data.author.managerInfo.bankBranch.bankName&&data.author.managerInfo.bankBranch.bankName!=''){
					shareParameters.description=data.author.managerInfo.bankBranch.bankName+"「"+data.author.managerInfo.calledName+"」"+"正在直播，快来一起观看吧~";
				}else{
					shareParameters.description="「"+data.author.managerInfo.calledName+"」"+"正在直播，快来一起观看吧~";
				}
			}else{
				shareParameters.description="「马上理财」正在直播，快来一起观看吧~";
			}
			
			if(data.roomId&&data.roomId!=''){
				shareParameters.roomId=data.roomId;
			}
			
			var wxShare = {
		        title:shareParameters.title,
		        description:shareParameters.description,
		        shareUrl:staticHost+"/html/video/index.html?roomId="+shareParameters.roomId,
		        icon:shareParameters.icon,
		        circleTitle:shareParameters.circleTitle
		    }
			
		    wxCallback(wxShare);
			
		}
		
		//直播提醒成功弹框
		function g_alert_video(msg){
		    var t;
		    clearTimeout(t);
		    if($('.g_alert_video').length<1){
		        $("body").append('<div class="g_alert_video">'+msg+'</div>');
		        var msg_w=$(".g_alert_video").width();
		        var msg_h=$(".g_alert_video").height();
		        $(".g_alert_video").css({"margin-left":-msg_w/2,"margin-top":-msg_h/2});
		        t=setTimeout("$('.g_alert_video').remove()",2000);
		    }
		}
		
		//点击播放视频和停止播放视频
		$(".content").on("click","video",function(){
			
			$("html").addClass("full");
			$("body").addClass("full");
			$(".content").css({"width":"100%","height":"100%"});
			
			$("video").attr({"height":"100%","width":"0"});
			
			var oAuto=$("video").attr("tit");
			
			var oVideo=document.getElementsByTagName("video")[0];
			if(oAuto==0){
				
				oVideo.play();
				
				$("video").attr("tit","1");
			}else{
				
				oVideo.pause();
				$("video").attr("tit","0");
			}
			
			return false;
		})
		
		//点击列表项中的“提醒我”按钮
		$(".prevue-direct").on("click",".remain",function(){
			
			var oKey=$(this).attr("key");
			$("[active]").attr("active","0");
			
			if(oKey==1){
				//获取元素容器的真实宽高值
				var oWidth=$(".content").width();
				var oHeight=$(".content").height();
				
				console.log(oWidth);
				console.log(oHeight);
				//保持元素填充第一屏
				
				var oVideo=$("video");
				if(oVideo.length>0){
					$("html").removeClass("full");
					$("body").removeClass("full");
					$(".content").css({"width":oWidth+"px","height":oHeight+"px"});
				}else{
					$("html").removeClass("full");
					$("body").removeClass("full");
					$(".content").css({"width":oWidth+"px","height":oHeight+"px"});
				}
				
				$(".mask").css("display","block");
				$(".int-list").css("display","block");
				
				$(this).attr("active","1");
				
				var mask=document.getElementsByClassName("mask")[0];
            	mask.addEventListener("touchmove",function(e){
               		e.preventDefault();
            	});
				
			}
			
			return false;
		})
		
		
		//点击预告直播内容页中的“提醒我”按钮
		$(".direct-prevue-box").on("click",".begin-open-remain",function(){
			
			var oKey=$(this).attr("key");
			
			if(oKey==1){

				//获取元素容器的真实宽高值
				var oWidth=$(".content").width();
				var oHeight=$(".content").height();
				
				console.log(oWidth);
				console.log(oHeight);
				//保持元素填充第一屏
				$("html").removeClass("full");
				$("body").removeClass("full");
				$(".content").css({"width":oWidth+"px","height":oHeight+"px"});
				
				$(".mask").css("display","block");
				$(".int-page").css("display","block");
				
				var mask=document.getElementsByClassName("mask")[0];
            	mask.addEventListener("touchmove",function(e){
               		e.preventDefault();
            	});
			}
			
			return false;
		})
		
		//点击列表项中的手机输入框“确定”按钮
		$(".mask").on("click",".list-confirm",function(){
			
			//保持元素填充第一屏
			var oVideo=$("video");
			var directPic=$(".direct-pic");
			if(oVideo.length>0){
				if(($("video").height()>$(".content").height())){
					$("html").addClass("full");
					$("body").addClass("full");
					$(".content").css({"width":"100%","height":"100%"});
				}else{
					$(".content").css("height",$("video").height()+"px");
				}
			}
			
			if(directPic.length>0){
				if(($(".direct-pic").height()>$(".content").height())){
					$("html").addClass("full");
					$("body").addClass("full");
					$(".content").css({"width":"100%","height":"100%"});
				}else{
					$(".content").css("height",$(".direct-pic").height()+"px");
				}
			}
			
			
			$(".mask").css("display","none");
			$(".int-list").css("display","none");
			g_alert_video("提醒成功");
			
			$("[active='1']").attr("key",0);
			$("[active='1']").html("已提醒");
			$("[active='1']").addClass("old");
			
			return false;
			
		})
		
		//点击列表项中的手机输入框“取消”按钮
		$(".mask").on("click",".list-cancle",function(){
			
			//保持元素填充第一屏
			var oVideo=$("video");
			var directPic=$(".direct-pic");
			if(oVideo.length>0){
				console.log($("video").height());
				if(($("video").height()>$(".content").height())){
					
					$("html").addClass("full");
					$("body").addClass("full");
					$(".content").css({"width":"100%","height":"100%"});
				}else{
					$(".content").css("height",$("video").height()+"px");
				}
			}
			
			if(directPic.length>0){
				if(($(".direct-pic").height()>$(".content").height())){
					$("html").addClass("full");
					$("body").addClass("full");
					$(".content").css({"width":"100%","height":"100%"});
				}else{
					$(".content").css("height",$(".direct-pic").height()+"px");
				}
			}
			
			
			$(".mask").css("display","none");
			$(".int-list").css("display","none");
			
			return false;
		})
		
		//点击内容页中的手机输入框“确定”按钮
		$(".mask").on("click",".page-confirm",function(){
			
			//保持元素填充第一屏
			$("html").addClass("full");
			$("body").addClass("full");
			$(".content").css({"width":"100%","height":"100%"});
			
			$(".mask").css("display","none");
			$(".int-page").css("display","none");
			g_alert_video("提醒成功");
			
			$(".begin-open-remain").attr("key","0");
			$(".begin-open-remain").text("已提醒");
			$(".begin-open-remain").css("color","#ccc");
			
			return false;
			
		})
		
		//点击内容页中的手机输入框“取消”按钮
		$(".mask").on("click",".page-cancle",function(){
			
			//保持元素填充第一屏
			$("html").addClass("full");
			$("body").addClass("full");
			$(".content").css({"width":"100%","height":"100%"});
			
			$(".mask").css("display","none");
			$(".int-page").css("display","none");
			
			return false;
		})
		
		//点击“查看回播”
		$(".content").on("click",".query-back-btn",function(){
			
			$(".direct-end-box").html("");
			$("html").addClass("full");
			$("body").addClass("full");
			$(".content").css({"width":"100%","height":"100%"});
			var str='';
			var str='<video height="100%" src="'+backDirectParameters.url+'"></video>';
			
			$(".direct-box").html(str);
			
			var oVideo=document.getElementsByTagName("video")[0];

			oVideo.play();
			
			return false;
		})
		
		
		//打开App
		var deepshareUrl = "http://a.app.qq.com/o/simple.jsp?pkgname=com.mashanglc.android.licaiclient";
		var params =
		{
			download_title : "马上理财-银行官方合作的理财产品神器",
			download_msg : "下载马上理财APP",
		};

		$.ajax({
			url: 'https://fds.so/v2/url/bdc8dc38688e526c',
			type: 'POST',
			data: JSON.stringify(params),
			xhrFields: {withCredentials: true,},
			success: function(result) {
				deepshareUrl = result.url;
			},
			error: function() {
			},
		});
		
		
		//点击头部"立即打开"按钮
		$(".top").on("click",".open",function(){
			location.href=deepshareUrl;
			return false;
		})
		
		//点击"打开App"
		$(".content").on("click",".download-btn",function(){
			location.href=deepshareUrl;
			return false;
		})
		
	})

</script>
</body>
</html>





